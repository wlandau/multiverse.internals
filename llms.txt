# multiverse.internals

[![check](https://github.com/r-multiverse/multiverse.internals/actions/workflows/check.yaml/badge.svg)](https://github.com/r-multiverse/multiverse.internals/actions?query=workflow%3Acheck)

The `multiverse.internals` supports:

1.  Interactive tools to help developers and moderators contribute
    packages to [R-multiverse](https://r-multiverse.org).
2.  Internal infrastructure to support the automation that powers
    [R-multiverse](https://r-multiverse.org).

Please visit
<https://r-multiverse.org/multiverse.internals/reference/index.html> for
documentation. To ask questions and post issues about this package or
[R-multiverse](https://r-multiverse.org) in general, please visit
<https://github.com/r-multiverse/help>.

## Installation

You can install the latest release of `multiverse.internals` from
[R-multiverse](https://r-multiverse.org).

``` r
install.packages(
  "multiverse.internals",
  repos = c("https://community.r-multiverse.org", getOption("repos"))
)
```

You can install the development version from
[GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("r-multiverse/multiverse.internals")
```

## Manual package reviews

The
[`review_package()`](https://r-multiverse.org/multiverse.internals/reference/review_package.md)
function helps contributors and moderators check packages for compliance
with [R-multiverse policies](https://r-multiverse.org/policies.html). It
attempts to run all the checks at
<https://r-multiverse.org/review.html#automatic-acceptance> which can be
performed using the package name and URL alone. These checks are not
exhaustive, and it might not be feasible to run them all, but they do
help with manual reviews.

``` r
library(multiverse.internals)
review_package(
  name = "webchem",
  url = "https://github.com/ropensci/webchem"
)
#> ✔ package webchem passed cursory checks for policy compliance.
```

``` r
review_package(
  name = "polars",
  url = "https://github.com/pola-rs/r-polars"
)
#> ✖ package polars did not pass cursory checks for policy compliance. Findings:
#> 
#> Package name 'polars' is different from the repository name in the URL 'https://github.com/pola-rs/r-polars'
```

Sometimes,
[`review_package()`](https://r-multiverse.org/multiverse.internals/reference/review_package.md)
may not be able to run all its checks.

``` r
review_package(
  name = "wrongpackage",
  url = "https://github.com/ropensci/invalid-repo-name"
)
#> ✖ package wrongpackage did not pass cursory checks for policy compliance. Findings:
#> 
#> URL 'https://github.com/ropensci/invalid-repo-name' returned HTTP error 404 | Not Found
#> 
#> WARNING: for security and/or practical reasons some pre-registration checks were skipped. Please manually check the package for compliance with R-multiverse policies. In particular, please check the license with multiverse.internals::review_license().
```

In those cases, it is critical to manually run
[`review_license()`](https://r-multiverse.org/multiverse.internals/reference/review_license.md)
on the `"License:"` string in the package’s `DESCRIPTION` file.
[R-multiverse](https://r-multiverse.org) requires that each package has
a valid free open-source (FOSS) license.

``` r
review_license("MIT + file LICENSE")
#> ✔ License "MIT + file LICENSE" is okay.
```

``` r
review_license("file LICENSE")
#> ✖ License "file LICENSE" is prohibited.
```

# Package index

## Manual package reviews

- [`review_license()`](https://r-multiverse.org/multiverse.internals/reference/review_license.md)
  : Review a package license.
- [`review_package()`](https://r-multiverse.org/multiverse.internals/reference/review_package.md)
  : Review a package.

## Automated package reviews

- [`review_pull_request()`](https://r-multiverse.org/multiverse.internals/reference/review_pull_request.md)
  : Review an R-multiverse contribution pull request.
- [`review_pull_requests()`](https://r-multiverse.org/multiverse.internals/reference/review_pull_requests.md)
  : Review R-multiverse contribution pull requests.

## Metadata

- [`meta_packages()`](https://r-multiverse.org/multiverse.internals/reference/meta_packages.md)
  : List package metadata
- [`meta_snapshot()`](https://r-multiverse.org/multiverse.internals/reference/meta_snapshot.md)
  : Snapshot metadata

## Package issues

- [`issues_advisories()`](https://r-multiverse.org/multiverse.internals/reference/issues_advisories.md)
  : Report package advisories

- [`issues_dependencies()`](https://r-multiverse.org/multiverse.internals/reference/issues_dependencies.md)
  : Report package dependency issues

- [`issues_licenses()`](https://r-multiverse.org/multiverse.internals/reference/issues_licenses.md)
  : Report package license issues

- [`issues_r_cmd_check()`](https://r-multiverse.org/multiverse.internals/reference/issues_r_cmd_check.md)
  :

  R-universe package `R CMD check` issues.

- [`issues_remotes()`](https://r-multiverse.org/multiverse.internals/reference/issues_remotes.md)
  :

  Report packages with `Remotes:` fields.

- [`issues_synchronization()`](https://r-multiverse.org/multiverse.internals/reference/issues_synchronization.md)
  : Report package check synchronization issues.

- [`issues_versions()`](https://r-multiverse.org/multiverse.internals/reference/issues_versions.md)
  : Package version issues.

- [`issues_version_conflicts()`](https://r-multiverse.org/multiverse.internals/reference/issues_version_conflicts.md)
  : Report packages with version conflicts in another repository.

## Recording package information

- [`record_status()`](https://r-multiverse.org/multiverse.internals/reference/record_status.md)
  : Record package status.
- [`record_nonstandard_licenses()`](https://r-multiverse.org/multiverse.internals/reference/record_nonstandard_licenses.md)
  : Record nonstandard licenses
- [`record_versions()`](https://r-multiverse.org/multiverse.internals/reference/record_versions.md)
  : Record the manifest of package versions.

## Staging

- [`filter_meta()`](https://r-multiverse.org/multiverse.internals/reference/filter_meta.md)
  :

  Filter `PACKAGES` and `PACKAGES.gz` metadata files.

- [`freeze_dependencies()`](https://r-multiverse.org/multiverse.internals/reference/freeze_dependencies.md)
  : Freeze dependencies

- [`rclone_includes()`](https://r-multiverse.org/multiverse.internals/reference/rclone_includes.md)
  : Write Rclone includes.

- [`stage_candidates()`](https://r-multiverse.org/multiverse.internals/reference/stage_candidates.md)
  : Stage release candidates

## Websites

- [`interpret_status()`](https://r-multiverse.org/multiverse.internals/reference/interpret_status.md)
  : Interpret the status of a package
- [`update_status()`](https://r-multiverse.org/multiverse.internals/reference/update_status.md)
  : Update the package status repository
- [`update_topics()`](https://r-multiverse.org/multiverse.internals/reference/update_topics.md)
  : Update topics

